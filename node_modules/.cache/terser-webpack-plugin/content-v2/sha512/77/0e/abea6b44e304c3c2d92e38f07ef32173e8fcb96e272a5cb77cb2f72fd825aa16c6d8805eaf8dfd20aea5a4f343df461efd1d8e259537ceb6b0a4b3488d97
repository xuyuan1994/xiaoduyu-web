{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{765:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;var r=u(n(0)),a=u(n(779)),i=u(n(780)),o=u(n(873)),c=u(n(782));function u(e){return e&&e.__esModule?e:{default:e}}var l=(0,a.default)((function(){return r.default.createElement(r.default.Fragment,null,r.default.createElement(i.default,{title:\"创建话题\"}),r.default.createElement(c.default,null,r.default.createElement(o.default,null)))}));t.default=l},779:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(e){var t=function(t){t.history;var n=t.location,l=t.match;t.staticContext;\"undefined\"!=typeof window&&i.set(\"history\",(0,a.default)().history);var s,d,f=(0,r.useState)(\"\"),p=(d=2,function(e){if(Array.isArray(e))return e}(s=f)||function(e,t){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}}(s,d)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()),m=p[0],v=p[1],h=(0,o.useStore)(),y=n.pathname,g=n.search;return n.params=g?(0,u.default)(g):{},(0,r.useEffect)((function(){return\"undefined\"!=typeof window&&\"/\"!=window.location.pathname&&(0,c.setScrollPosition)(y+g)(h.dispatch,h.getState),function(){\"undefined\"!=typeof window&&i.remove(\"history\")}}),[]),m?r.default.createElement(\"div\",{className:\"container text-center\"},m):r.default.createElement(e,{match:l,setNotFound:v})};return t.loadDataOnServer=e.loadDataOnServer||function(){return{code:200}},t};var r=d(n(0)),a=l(n(277)),i=d(n(116)),o=n(168),c=n(278),u=l(n(781));function l(e){return e&&e.__esModule?e:{default:e}}function s(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function d(e){if(e&&e.__esModule)return e;var t=s();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}}return n.default=e,t&&t.set(e,n),n}},780:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(e){var t=e.title,n=e.children,r=(0,o.useSelector)((function(e){return(0,c.getUnreadNotice)(e)})),s=(0,o.useSelector)((function(e){return(0,u.getTipsById)(e,\"home\")||(0,u.getTipsById)(e,\"feed\")||(0,u.getTipsById)(e,\"favorite\")||(0,u.getTipsById)(e,\"excellent\")})),d=(0,o.useSelector)((function(e){return(0,u.getTipsById)(e,\"unread-message\")})),f=\"\";d&&(f+=\"(\".concat(d,\"条私信) \"));r&&r.length>0&&(f+=\"(\".concat(r.length,\"条通知) \"));s&&(f+=\"(有新动态) \");f+=t||l.name,t&&(f+=\" - \".concat(l.name));return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.ReactTitle,{title:f}),n?a.default.createElement(i.default,null,n):null)};var r,a=(r=n(0))&&r.__esModule?r:{default:r},i=function(e){if(e&&e.__esModule)return e;var t=s();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}}n.default=e,t&&t.set(e,n);return n}(n(691)),o=n(168),c=n(169),u=n(170),l=n(77);function s(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}},781:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;var r=function(e){return e.substr(1).split(\"&\").reduce((function(e,t){if(t){var n=t.split(\"=\");e[n[0]]=n[1]||\"\"}return e}),{})};t.default=r},782:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(e){var t=e.children;return a.default.createElement(\"div\",{className:\"container\"},a.default.createElement(\"div\",{className:\"_3RUsQ\"},t))};var r,a=(r=n(0))&&r.__esModule?r:{default:r};n(692)},783:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(e){e.size,e.position;return a.default.createElement(\"span\",{className:\"_3H7UH\"})};var r,a=(r=n(0))&&r.__esModule?r:{default:r};n(693)},787:function(e,t,n){\"use strict\";(function(e){Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(t){var n=t.content,u=t.maxHeight;if(!n)return null;var l=s((0,r.useState)(n),2),d=l[0],f=l[1],p=s((0,r.useState)(!1),2),m=p[0],v=p[1],h=s((0,r.useState)(0),2),y=h[0],g=h[1],_=(0,r.createRef)();return(0,r.useEffect)((function(){f((0,i.default)(n)),o.default.registerLanguage(\"javascript\",c.default),e(\".markdown-body pre\").each((function(e,t){o.default.highlightBlock(t)})),a.default.spacingElementByClassName(\"markdown-body\"),y||g(_&&_.current?_.current.offsetHeight:0)}),[n]),r.default.createElement(\"div\",null,r.default.createElement(\"div\",{ref:_,style:!m&&u&&y>u?{maxHeight:\"\".concat(u,\"px\"),overflow:\"hidden\"}:null,className:\"markdown-body _1_Fpd\",dangerouslySetInnerHTML:{__html:d}}),function(){return m||!u||y<u?null:r.default.createElement(\"div\",{className:\"_2GBbo\"},r.default.createElement(\"span\",{className:\"btn btn-outline-primary btn-block btn-sm mt-3\",onClick:function(e){e.stopPropagation(),v(!m)}},!m&&u&&y>u?\"展开全部\":\"收起\"))}())};var r=function(e){if(e&&e.__esModule)return e;var t=l();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}}n.default=e,t&&t.set(e,n);return n}(n(0)),a=u(n(695));n(696);var i=u(n(790)),o=u(n(697)),c=u(n(698));function u(e){return e&&e.__esModule?e:{default:e}}function l(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}}).call(this,n(68))},788:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.addPosts=function(e){var t=e.title,n=e.detail,r=e.detailHTML,a=e.topicId,i=e.device,c=e.type;return function(e,u){return new Promise(function(){var e=d(regeneratorRuntime.mark((function e(s){var d,f,p,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.default)({type:\"mutation\",apis:[{api:\"addPosts\",args:{title:t,content:n,content_html:r,topic_id:a,device_id:i,type:c},fields:\"\\n        success\\n        _id\\n        \"}],headers:{accessToken:u().user.accessToken}});case 2:d=e.sent,f=l(d,2),p=f[0],m=f[1],s([p,m]);case 7:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},t.viewPostsById=function(e){var t=e.id;return(function(){var e=d(regeneratorRuntime.mark((function e(n,a){var i,u,s,d,f,p,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.default)(r.default.load({key:\"view-posts\"}));case 2:if(i=e.sent,u=l(i,2),u[0],s=u[1],(d=(d=s||\"\").split(\",\"))[0]||(d=[]),-1!=d.indexOf(t)){e.next=19;break}return d.push(t),r.default.save({key:\"view-posts\",data:d.join(\",\"),expires:36e5}),e.next=14,(0,o.default)({type:\"mutation\",apis:[{api:\"viewPosts\",args:{posts_id:t},fields:\"success\"}]});case 14:f=e.sent,p=l(f,2),p[0],(m=p[1])&&m.success&&n({type:\"UPDATE_POSTS_VIEW\",id:t});case 19:case\"end\":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},t.updatePosts=function(e){var t=e.id,n=e.title,r=e.detail,a=e.detailHTML,i=e.topicId;e.topicName;return(function(){var e=d(regeneratorRuntime.mark((function e(c,u){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",new Promise(function(){var e=d(regeneratorRuntime.mark((function e(s,d){var p,m,v,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p={_id:t,title:n,content:r,content_html:a,topic_id:i},e.next=3,(0,o.default)({type:\"mutation\",apis:[{api:\"updatePosts\",args:JSON.parse(JSON.stringify(p)),fields:\"success\"}],headers:{accessToken:u().user.accessToken}});case 3:if(m=e.sent,v=l(m,2),h=v[0],v[1],!h){e.next=9;break}return e.abrupt(\"return\",d(h));case 9:f({id:t,args:{_id:t},restart:!0})(c,u).then((function(e){var n=l(e,2),r=(n[0],n[1]),a=r&&r.data&&r.data[0]?r.data[0]:null;a?c({type:\"UPDATE_POST\",id:t,update:a}):s(r),s(r)}));case 10:case\"end\":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case\"end\":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},t.refreshPostsListById=t.removePostsListById=t.loadPostsList=void 0;var r=u(n(172)),a=n(171),i=u(n(785)),o=u(n(48)),c=u(n(118));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}function s(e,t,n,r,a,i,o){try{var c=e[i](o),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){s(i,r,a,o,c,\"next\",e)}function c(e){s(i,r,a,o,c,\"throw\",e)}o(void 0)}))}}var f=(0,u(n(117)).default)({reducerName:\"posts\",actionType:\"SET_POSTS_LIST_BY_ID\",processList:function(e,t,n){return e.map((function(e){if(e.device&&(e._device=i.default.getNameByDeviceId(e.device)),e.content_html&&\"<p><br></p>\"==e.content_html&&(e.content_html=\"\"),e.content_html){e.images=p(e.content_html),e.images&&e.images.length>0&&(e._coverImage=e.images[0].split(\"?\")[0]+\"?imageView2/2/w/300/auto-orient/format/jpg\");for(var t,n=e.content_html,r=/<img(.*?)>/gi,o=[];t=r.exec(n);)o.push(t[0]);o.map((function(e){n=n.replace(e,\"[图片] \")})),(n=(n=(n=n.replace(/<[^>]+>/g,\"\")).replace(/\\r\\n/g,\"\")).replace(/\\n/g,\"\")).length>137&&(n=n.slice(0,137)+\"...\"),e.content_summary=n,e.content_html=m(e.content_html)}e.create_at&&(e._create_at=(0,a.dateDiff)(e.create_at)),e.sort_by_date&&(e._sort_by_date=(0,a.dateDiff)(e.sort_by_date)),e.last_comment_at&&(e._last_comment_at=(0,a.dateDiff)(e.last_comment_at)),e.update_at&&(e._update_at=(0,a.dateDiff)(e.update_at))})),e},api:\"posts\",fields:\"\\n  _id\\n  comment_count\\n  reply_count\\n  content_html\\n  create_at\\n  deleted\\n  device\\n  follow_count\\n  last_comment_at\\n  like_count\\n  recommend\\n  sort_by_date\\n  title\\n  ip\\n  topic_id{\\n    _id\\n    name\\n    parent_id {\\n      _id\\n      name\\n    }\\n  }\\n  type\\n  user_id{\\n    _id\\n    nickname\\n    brief\\n    avatar_url\\n    posts_count\\n    comment_count\\n    fans_count\\n    follow_people_count\\n    follow\\n  }\\n  verify\\n  view_count\\n  weaken\\n  follow\\n  like\\n  update_at\\n  \"});t.loadPostsList=f;t.removePostsListById=function(e){return function(t,n){t({type:\"REMOVE_POSTS_LIST_BY_ID\",id:e})}};t.refreshPostsListById=function(e){return function(t,n){var r=n().posts[e]||null;if(r&&r.filters)return delete r.filters.page_size,delete r.filters.page_number,f({id:e,args:r.filters,restart:!0})(t,n).then((function(e){var r=l(e,2),a=(r[0],r[1]);if(a&&a.data&&a.data.length>0){var i={};a.data.map((function(e){i[e._id]=e}));var o=n().posts;Reflect.ownKeys(o).map((function(e){n().posts[e].data.map((function(e){i[e._id]&&(i[e._id].comment_count&&(e.comment_count=i[e._id].comment_count),i[e._id].reply_count&&(e.reply_count=i[e._id].reply_count),i[e._id].follow_count&&(e.follow_count=i[e._id].follow_count),i[e._id].like_count&&(e.like_count=i[e._id].like_count))}))})),t({type:\"SET_POSTS\",state:o})}}))}};var p=function(e){for(var t,n=/<img(?:(?:\".*?\")|(?:'.*?')|(?:[^>]*?))*>/gi,r=/src=[\\'\\\"]?([^\\'\\\"]*)[\\'\\\"]?/i,a=[];t=n.exec(e);){var i=t[0].match(r);i&&i[1]&&(-1!=(i=i[1])[1].indexOf(\"xiaoduyu.com\")&&(i=i[1]+\"?imageView2/2/w/800/auto-orient/format/jpg\"),a.push(i))}return a},m=function(e){for(var t,n=/<img(?:(?:\".*?\")|(?:'.*?')|(?:[^>]*?))*>/gi,r=/src=[\\'\\\"]?([^\\'\\\"]*)[\\'\\\"]?/i;t=n.exec(e);){var a=t[0];if(a){var i=a.match(r);if(i&&i[1]&&-1!=i[1].indexOf(\"xiaoduyu.com\")){var o=a.replace(i[1],i[1]+\"?imageView2/2/w/800/auto-orient/format/jpg\");e=e.replace(a,o)}}}return e}},790:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;function r(e){e=e||32;for(var t=\"ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678\",n=t.length,r=\"\",a=0;a<e;a++)r+=t.charAt(Math.floor(Math.random()*n));return r}t.default=function(e){return e?e=function(e){var t=e.match(/\\<img(.*?)>/g),n=function(e){var t=/src=[\\'\\\"]?([^\\'\\\"]*)[\\'\\\"]?/i,n=[],r=e.match(/\\<img(.*?)>/g);return r&&r.length>0&&r.map((function(e){var r=e.match(t);r&&r[1]&&n.push(r[1])})),n}(e);return n.map((function(e,t){n[t]=e.split(\"?\")[0]})),n=\"['\"+n.join(\"','\")+\"']\",t&&t.length>0&&t.map((function(t,r){var a=t;a=a.replace(/\\?/g,\"\\\\?\"),e=e.replace(new RegExp(a,\"gm\"),'<div onclick=\"webPictureViewer('+n+\",\"+r+');\">'+t+\"</div>\")})),e}(e=function(e){if(!e)return\"\";e=e.replace(\"&nbsp;\",\" \");var t=/(<a(.*?)>(.*?)<\\/a>|<img(.*?)>|<ifram(.*?)>)/gi,n=[],a=e.match(t);a&&a.length>0&&e.match(t).map((function(t){var a=\"#\"+r(18)+\"#\";n.push({id:a,value:t}),e=e.replace(t,a)}));var i=e.match(/(http:\\/\\/>http:\\/\\/|http:\\/\\/|https:\\/\\/|www\\.|magnet\\:\\?xt\\=)(.*?)(?=\\s|http|https|\\)|\\>|\\]|\\}|\\<|\\\"|\\'|$)/gi);if(i&&i.length>0){i=i.sort((function(e,t){return t.length-e.length}));var o=[];i.map((function(t){var n=\"#\"+r(18)+\"#\";o.push({id:n,value:t}),e=e.replace(t,n)})),o.map((function(t){var n=-1==t.value.indexOf(\"http\")?\"http:\"+t.value:t.value;e=e.replace(t.id,\"<a href=\".concat(n,' target=\"_blank\" rel=\"nofollow\">').concat(t.value,\"</a>\"))}))}return n.length>0&&n.map((function(t){e=e.replace(t.id,t.value)})),e}(e=function(e){var t=e.match(/(https:\\/\\/v\\.|http:\\/\\/v\\.|v\\.)qq\\.com\\/x\\/(page|cover)\\/(.*?)(?=\\s|http|https|\\)|\\>|\\]|\\}|\\<|$)/gi);return t&&0!=t.length?(t.map((function(t){var n;try{var r=t.split(\"?\")[0].split(\".\");r=r[r.length-2].split(\"/\"),n=t.split(\"?\")[0].split(\"/\").pop().split(\".\")[0]}catch(e){console.log(e)}if(n){var a=\"//v.qq.com/txp/iframe/player.html?vid=\".concat(n);e=e.replace(t,'<iframe frameborder=\"0\" src=\"'.concat(a,'\" allowFullScreen=\"true\"></iframe>'))}})),e):e}(e=function(e){var t=e.match(/(https:\\/\\/www\\.youtube\\.com|https:\\/\\/youtube\\.com|http:\\/\\/www.youtube\\.com|http:\\/\\/youtube\\.com|www\\.youtube\\.com|youtube\\.com)\\/watch\\?v\\=(.*?)(?=\\s|http|https|\\)|\\>|\\]|\\}|\\<|$)/gi);return t&&0!=t.length?(t.map((function(t){var n;try{t.split(\"?\")[1].split(\"&\").map((function(e){var t=e.split(\"=\");t&&\"v\"==t[0]&&(n=t[1])}))}catch(e){console.log(e)}if(n){var r=\"//www.youtube.com/embed/\".concat(n);e=e.replace(t,'<iframe width=\"100%\" style=\"background:#f9f9f9;\" src=\"'.concat(r,'\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>'))}})),e):e}(e=function(e){var t=e.match(/(https:\\/\\/www\\.acfun\\.cn|https:\\/\\/acfun\\.cn|http:\\/\\/www.acfun\\.cn|http:\\/\\/acfun\\.cn|www\\.acfun\\.cn|acfun\\.cn)\\/v\\/(.*?)(?=\\s|http|https|\\)|\\>|\\]|\\}|\\<|$)/gi);return t&&0!=t.length?(t.map((function(t){var n;try{n=(n=t.split(\"acfun.cn/v/\")[1].split(\"/\")[0]).split(\"?\")[0]}catch(e){console.log(e)}if(n){var r=\"https://www.acfun.cn/player/\".concat(n);e=e.replace(t,'<iframe src=\"'.concat(r,'\" id=\"ACFlashPlayer-re\"  scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\"></iframe>'))}})),e):e}(e=function(e){var t=e.match(/(https:\\/\\/www\\.bilibili\\.com|https:\\/\\/bilibili\\.com|http:\\/\\/www.bilibili\\.com|http:\\/\\/bilibili\\.com|www\\.bilibili\\.com|bilibili\\.com)\\/video\\/av(.*?)(?=\\s|http|https|\\)|\\>|\\]|\\}|\\<|$)/gi);return t&&0!=t.length?(t.map((function(t){var n;try{n=(n=t.split(\"bilibili.com/video/av\")[1].split(\"/\")[0]).split(\"?\")[0]}catch(e){console.log(e)}if(n){var r=\"//player.bilibili.com/player.html?aid=\".concat(n);e=e.replace(t,'<iframe src=\"'.concat(r,'\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\"></iframe>'))}})),e):e}(e=function(e){var t=e.match(/(http:\\/\\/v\\.youku\\.com|https:\\/\\/v\\.youku\\.com|v\\.youku\\.com)\\/v\\_show\\/id\\_(.*?)(?=\\s|http|https|\\)|\\>|\\]|\\}|\\<|$)/gi);return t&&0!=t.length?(t.map((function(t){var n;try{n=(n=t.split(\"v.youku.com/v_show/id_\")[1].split(\".\")[0]).split(\"?\")[0]}catch(e){console.log(e)}if(n){var r=\"//player.youku.com/embed/\".concat(n);e=e.replace(t,\"<iframe width='100%' src='\".concat(r,\"' frameborder=0 'allowfullscreen'></iframe>\"))}})),e):e}(e=function(e){var t=e.match(/(http:\\/\\/music\\.163\\.com|https:\\/\\/music\\.163\\.com|music\\.163\\.com)\\/(.*?)(?=\\s|http|https|\\)|\\>|\\]|\\}|\\<|$)/gi);return t&&t.length>0&&t.map((function(t){var n,r=-1;-1!=t.indexOf(\"/song?\")?r=2:-1!=t.indexOf(\"/playlist?\")?r=0:-1!=t.indexOf(\"/album?\")?r=1:-1!=t.indexOf(\"/dj?\")?r=3:-1!=t.indexOf(\"/radio/?\")&&(r=4);try{t.split(\"?\")[1].split(\"&\").map((function(e){var t=e.split(\"=\");\"id\"==t[0]&&(n=t[1])}))}catch(e){console.log(e)}if(-1!=r&&n)if(2==r){var a=\"//music.163.com/outchain/player?type=2&id=\".concat(n,\"&auto=0&height=66\");e=e.replace(t,'<iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=330 height=86 src=\"'.concat(a,'\"></iframe>'))}else if(3==r){var i=\"//music.163.com/outchain/player?type=3&id=\".concat(n,\"&auto=1&height=66\");e=e.replace(t,'<iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=330 height=86 src=\"'.concat(i,'\"></iframe>'))}else if(4==r){var o=\"//music.163.com/outchain/player?type=4&id=\".concat(n,\"&auto=1&height=430\");e=e.replace(t,'<iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=330 height=450 src=\"'.concat(o,'\"></iframe>'))}else{var c=\"//music.163.com/outchain/player?type=\".concat(r,\"&id=\").concat(n,\"&height=430\");e=e.replace(t,'<iframe type=\"music\" src=\"'.concat(c,'\" height=\"430\"></iframe>'))}})),e}(e=function(e){var t=e.match(/\\<pre>(.*?)<\\/pre>/g),n=[];t&&t.length>0&&t.map((function(t){var a=\"#\"+r(18)+\"#\";n.push({id:a,value:t}),e=e.replace(t,a)}));var a=(e=e.replace(/([\\r\\n])/g,\"\")).split(\"<p><br></p>\");return a=function(e){for(var t=[],n=0;n<e.length;n++)-1==t.indexOf(e[n])&&t.push(e[n]);return t.length>0&&!t[0]&&t.splice(0,1),t.length>0&&!t[t.length-1]&&t.splice(t.length-1,1),t}(a),e=a.join(\"<p><br></p>\"),n.length>0&&n.map((function(t){e=e.replace(t.id,t.value)})),e}(e))))))))):\"\"}},795:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;var r,a=(r=n(0))&&r.__esModule?r:{default:r};t.default=function(e){var t=e.id,n=void 0===t?\"\":t,r=e.header,i=void 0===r?null:r,o=e.title,c=void 0===o?\"\":o,u=e.body,l=void 0===u?\"\":u,s=e.footer,d=void 0===s?\"\":s,f=e.position,p=void 0===f?\"\":f,m=e.size,v=\"modal-dialog\";return p||(v+=\" modal-dialog-centered\"),(void 0===m?\"\":m)&&(v+=\" modal-lg\"),a.default.createElement(\"div\",{className:\"modal fade\",id:n,tabIndex:\"-1\",role:\"dialog\",\"aria-labelledby\":\"exampleModalLabel\",\"aria-hidden\":\"true\"},a.default.createElement(\"div\",{className:v,role:\"document\"},a.default.createElement(\"div\",{className:\"modal-content\"},c?a.default.createElement(\"div\",{className:\"modal-header\"},c,a.default.createElement(\"button\",{type:\"button\",className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"},a.default.createElement(\"span\",{\"aria-hidden\":\"true\"},\"×\"))):null,i&&a.default.createElement(\"div\",{className:\"modal-header\",style:{border:\"none\",paddingBottom:\"0px\"}},a.default.createElement(\"div\",null,i),a.default.createElement(\"div\",null,a.default.createElement(\"button\",{type:\"button\",className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"},a.default.createElement(\"span\",{\"aria-hidden\":\"true\"},\"×\")))),a.default.createElement(\"div\",{className:\"modal-body\"},l),d?a.default.createElement(\"div\",{className:\"modal-footer\"},d):null)))}},873:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(){var e=m((0,r.useState)(null),2),t=e[0],n=e[1],s=m((0,r.useState)(!0),2),d=s[0],v=s[1],h=(0,i.useStore)(),y=(0,a.default)(),g=y.history,_=y.location;y.match;(0,r.useEffect)((function(){var e=_.params.posts_id;function r(){var t;return t=regeneratorRuntime.mark((function t(){var r,a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v(!0),t.next=3,(0,o.loadPostsList)({id:\"edit_\"+e,args:{_id:e},fields:\"\\n          _id\\n          title\\n          content\\n          content_html\\n          topic_id{\\n            _id\\n            name\\n          }\\n        \"})(h.dispatch,h.getState);case 3:a=t.sent,(i=m(a,2))[0],(r=i[1])&&r.data&&r.data[0]&&(n(r.data[0]),v(!1));case 8:case\"end\":return t.stop()}}),t)})),(r=function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(e){p(i,r,a,o,c,\"next\",e)}function c(e){p(i,r,a,o,c,\"throw\",e)}o(void 0)}))}).apply(this,arguments)}e&&!t?function(){r.apply(this,arguments)}():v(!1)}),[]);var b=function(e){g.push(\"/posts/\".concat(e._id))};return d?r.default.createElement(u.default,null):r.default.createElement(l.default,null,t?r.default.createElement(c.default,f({successCallback:b},t)):r.default.createElement(c.default,{successCallback:b}))};var r=function(e){if(e&&e.__esModule)return e;var t=d();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}}n.default=e,t&&t.set(e,n);return n}(n(0)),a=s(n(277)),i=n(168),o=n(788),c=s(n(874)),u=s(n(783)),l=s(n(782));function s(e){return e&&e.__esModule?e:{default:e}}function d(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t,n,r,a,i,o){try{var c=e[i](o),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}},874:function(e,t,n){\"use strict\";(function(e){Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(t){var n=t._id,h=t.successCallback,y=(0,i.default)().location,_=(0,a.useRef)(),O=w((0,a.useState)(t.content||\"\"),2),k=O[0],E=O[1],x=w((0,a.useState)(t.content_html||\"\"),2),P=x[0],j=x[1],S=w((0,a.useState)(t.topic_id||null),2),M=S[0],T=S[1],N=w((0,a.useState)(a.default.createElement(\"div\",null)),2),I=N[0],R=N[1],A=w((0,a.useState)(!1),2),D=A[0],C=A[1],B=w((0,a.useState)(null),2),L=(B[0],B[1]),H=w((0,a.useState)(!1),2),W=H[0],U=H[1],z=(0,c.useSelector)((function(e){return(0,s.getTopicListById)(e,\"new-posts\")})),F=(0,c.useStore)(),$=function(e){return(0,u.addPosts)(e)(F.dispatch,F.getState)},q=function(e,t){E(e),j(t),n||o.default.save({key:\"posts-content\",data:e})},V=function(){var e=b(regeneratorRuntime.mark((function e(){var t,r,a,i,c,l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=_.current,!D){e.next=3;break}return e.abrupt(\"return\");case 3:if(M){e.next=5;break}return e.abrupt(\"return\",alert(\"您还未选择话题\"));case 5:if(t.value){e.next=7;break}return e.abrupt(\"return\",t.focus());case 7:if(-1==P.indexOf('<img src=\"\">')){e.next=10;break}return Toastify({text:\"有图片上传中，请等待上传完成后再提交\",duration:3e3,backgroundColor:\"linear-gradient(to right, #0988fe, #1c75fb)\"}).showToast(),e.abrupt(\"return\");case 10:if(C(!0),!n){e.next=21;break}return e.next=14,(0,f.default)((p={id:n,topicId:M._id,topicName:M.name,title:t.value,detail:k,detailHTML:P},(0,u.updatePosts)(p)(F.dispatch,F.getState)));case 14:return i=e.sent,c=w(i,2),r=c[0],a=c[1],C(!1),r?Toastify({text:r.message||\"提交失败，请重新尝试\",duration:3e3,backgroundColor:\"linear-gradient(to right, #ff6c6c, #f66262)\"}).showToast():h({_id:n}),e.abrupt(\"return\");case 21:return e.next=23,$({title:t.value,detail:k,detailHTML:P,topicId:M._id,device:d.default.getCurrentDeviceId(),type:1});case 23:l=e.sent,s=w(l,2),r=s[0],(a=s[1])&&a.success?(setTimeout((function(){o.default.save({key:\"posts-title\",data:\"\"}),o.default.save({key:\"posts-content\",data:\"\"})}),200),setTimeout((function(){C(!1),h(a),Toastify({text:\"提交成功\",duration:3e3,backgroundColor:\"linear-gradient(to right, #50c64a, #40aa33)\"}).showToast()}),1500)):(C(!1),Toastify({text:r.message,duration:3e3,backgroundColor:\"linear-gradient(to right, #ff6c6c, #f66262)\"}).showToast());case 28:case\"end\":return e.stop()}var p}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=b(regeneratorRuntime.mark((function e(){var r,i,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z){e.next=3;break}return e.next=3,d={id:\"new-posts\",args:{sort_by:\"sort:-1\",parent_id:\"not-exists\",page_size:1e3}},(0,l.loadTopicList)(d)(F.dispatch,F.getState);case 3:if(r=(0,s.getTopicListById)(F.getState(),\"new-posts\"),(i=y.params.topic_id)&&!M&&r&&r.data&&r.data[0]&&r.data.map((function(e){e.children.map((function(e){e._id==i&&T(e)}))})),c=\"\",u=\"\",!n){e.next=11;break}c=k,e.next=17;break;case 11:return e.next=13,o.default.load({key:\"posts-content\"});case 13:if(e.t0=e.sent,e.t0){e.next=16;break}e.t0=\"\";case 16:c=e.t0;case 17:if(!n){e.next=21;break}u=t.title||\"\",e.next=27;break;case 21:return e.next=23,o.default.load({key:\"posts-title\"});case 23:if(e.t1=e.sent,e.t1){e.next=26;break}e.t1=\"\";case 26:u=e.t1;case 27:R(a.default.createElement(\"div\",null,a.default.createElement(p.default,{syncContent:function(e,t){q(e,t)},content:c,placeholder:\"请输入正文\",expandControl:!0,getEditor:function(e){L(e)},showMarkdown:!0}))),_.current.value=u;case 29:case\"end\":return e.stop()}var d}),e)})));return function(){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){J()}),[]),a.default.createElement(\"div\",null,a.default.createElement(m.default,{id:\"topics-modal\",header:\"请选择一个话题\",body:a.default.createElement(\"div\",{className:\"_4Aq4e\"},z&&z.data.map((function(t){return a.default.createElement(\"div\",{key:t._id},a.default.createElement(\"div\",{className:\"text-secondary mt-3\"},t.name),a.default.createElement(\"div\",null,t.children&&t.children.map((function(t){return a.default.createElement(\"div\",{key:t._id,onClick:function(){!function(t){T(t),e(\"#topics-modal\").modal(\"hide\")}(t)},className:(0,r.default)(M&&M._id==t._id?\"active\":\"topic\",g)},t.name)}))))})))}),a.default.createElement(\"div\",{style:{overflow:\"hidden\"}},a.default.createElement(\"div\",{className:\"row\"},a.default.createElement(\"div\",{className:\"col-md-2 col-3 pr-0\"},a.default.createElement(\"span\",{className:\"a card border-right rounded-left border-0 _7_5h3\",\"data-toggle\":\"modal\",\"data-target\":\"#topics-modal\"},M?M.name:\"选择话题\")),a.default.createElement(\"div\",{className:\"col-md-10 col-9 pl-0\"},a.default.createElement(\"input\",{className:\"card rounded-right _3QU-z\",ref:_,type:\"text\",onChange:function(){if(n)return;o.default.save({key:\"posts-title\",data:_.current.value})},placeholder:\"请输入标题\"})))),a.default.createElement(\"div\",{className:\"card\"},I,a.default.createElement(\"div\",{className:\"card-footer\"},a.default.createElement(\"div\",{className:\"d-flex justify-content-between\"},a.default.createElement(\"div\",null,a.default.createElement(\"button\",{type:\"button\",className:\"btn btn-link btn-sm\",onClick:function(){return U(!W)}},W?\"关闭\":\"\",\"预览\")),a.default.createElement(\"div\",null,a.default.createElement(\"button\",{className:\"btn btn-block btn-primary rounded-pill btn-sm pl-3 pr-3\",onClick:V},D?\"发布中...\":\"发布\"))))),W?a.default.createElement(\"div\",{className:\"card mt-2\"},a.default.createElement(\"div\",{className:\"card-body\"},a.default.createElement(v.default,{content:decodeURIComponent(P)}))):null)};var r=y(n(280)),a=function(e){if(e&&e.__esModule)return e;var t=h();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}}n.default=e,t&&t.set(e,n);return n}(n(0)),i=y(n(277)),o=y(n(172)),c=n(168),u=n(788),l=n(283),s=n(173),d=y(n(785)),f=y(n(118)),p=y(n(802)),m=y(n(795)),v=y(n(787));function h(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return h=function(){return e},e}function y(e){return e&&e.__esModule?e:{default:e}}n(766);var g={\"./styles/index.scss\":{\"node-selector\":\"_3-FAU\",\"topics-container\":\"_4Aq4e\",close:\"kyEO5\",head:\"pGwtz\",topic:\"c-kRP\",active:\"_2cZUf\",mask:\"_1-Hs0\",\"choose-topic-button\":\"_7_5h3\",title:\"_3QU-z\",editor:\"_1Iz2E\",button:\"_2BgsM\"}};function _(e,t,n,r,a,i,o){try{var c=e[i](o),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){_(i,r,a,o,c,\"next\",e)}function c(e){_(i,r,a,o,c,\"throw\",e)}o(void 0)}))}}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}}).call(this,n(68))}}]);","extractedComments":[]}