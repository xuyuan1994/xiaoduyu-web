{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{785:function(e,t,n){\"use strict\";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;var a=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),o(this,\"devices\",void 0),o(this,\"show\",void 0),this.devices={1:\"unknow\",2:\"windows\",3:\"mac\",4:\"ipad\",5:\"iphone\",6:\"android\",7:\"ios-app\",8:\"android-app\"},this.show={1:\"\",2:\"\",3:\"\",4:\"\",5:\"\",6:\"\",7:\"通过 App iPhone 客户端\",8:\"通过 App Android 客户端\"}}var t,n,a;return t=e,(n=[{key:\"getCurrentDeviceId\",value:function(){if(\"undefined\"==typeof window||\"undefined\"==typeof document)return 1;var e=\"unknow\",t=navigator.platform,n=navigator.userAgent.toLowerCase(),r={windows:0==t.indexOf(\"Win\"),mac:0==t.indexOf(\"Mac\"),ipad:\"ipad\"==n.match(/ipad/i),iphone:\"iphone os\"==n.match(/iphone os/i),android:\"android\"==n.match(/android/i)};for(var o in r)r[o]&&(e=o);for(var o in this.devices)if(this.devices[o]==e)return parseInt(o);return 1}},{key:\"getNameByDeviceId\",value:function(e){return this.show[e]}},{key:\"isMobileDevice\",value:function(){var e=this.getCurrentDeviceId();return 5==e||6==e}}])&&r(t.prototype,n),a&&r(t,a),e}());t.default=a},802:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;var r=c(n(0)),o=n(164),a=n(778),i=c(n(711)),l=c(n(172)),u=c(n(805));function c(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n,r,o,a,i){try{var l=e[a](i),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,o)}function d(e){return(d=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function m(e,t){return!t||\"object\"!==d(t)&&\"function\"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){switch(e.getType()){case\"blockquote\":return\"RichEditor-blockquote\";default:return null}}function w(e,t,n){e.findEntityRanges((function(e){var t=e.getEntity();return null!==t&&\"LINK\"===n.getEntity(t).getType()}),t)}n(712),n(713);var C,S,E,T=function(e){var t=e.contentState.getEntity(e.entityKey).getData().url;return r.default.createElement(\"a\",{href:t},e.children)},_=function(e){function t(){var e;return f(this,t),(e=m(this,g(t).call(this))).onToggle=function(t){t.preventDefault(),e.props.onToggle(e.props.style)},e}return v(t,e),y(t,[{key:\"render\",value:function(){var e=\"RichEditor-styleButton\";return this.props.active&&(e+=\" RichEditor-activeButton\"),r.default.createElement(\"span\",{className:e+\" \"+this.props.className,onMouseDown:this.onToggle})}}]),t}(r.default.Component),O=[{className:\"title\",label:\"H2\",style:\"header-two\"},{className:\"ul\",label:\"ul\",style:\"unordered-list-item\"},{className:\"code-block\",label:\"code\",style:\"code-block\"}],x=[{className:\"bold\",label:\"bold\",style:\"BOLD\"},{className:\"italic\",label:\"italic\",style:\"ITALIC\"},{className:\"underline\",label:\"underline\",style:\"UNDERLINE\"}],j=function(e){var t=e.markdown,n=e.editorState,o=e.insertText,a=n.getSelection(),i=n.getCurrentContent().getBlockForKey(a.getStartKey()).getType(),l=e.editorState.getCurrentInlineStyle();return r.default.createElement(\"div\",{className:\"RichEditor-controls\"},!t&&e.expandControl&&O.map((function(t){return r.default.createElement(_,{key:t.label,active:t.style===i,label:t.label,onToggle:e.toggleBlockType,className:t.className,style:t.style})})),!t&&e.expandControl&&x.map((function(t){return r.default.createElement(_,{key:t.label,active:l.has(t.style),label:t.label,onToggle:e.toggleInlineStyle,className:t.className,style:t.style})})),r.default.createElement(u.default,{beforeUpload:function(n){if(!t){var r=[];n.map((function(e){r.push({name:e.name,src:\"\"})})),e.addImage(r)}},upload:function(n,r){t?o(\"![\".concat(r.name,\"](\").concat(n,' \"').concat(r.name,'\")')):e.updateImage(n,r)},text:r.default.createElement(\"span\",{className:\"RichEditor-styleButton image\"})}))},I=function(e){function t(e){var n;f(this,t);var r=(n=m(this,g(t).call(this,e))).props,a=r.syncContent,i=r.content,l=r.placeholder,u=r.expandControl,c=new o.CompositeDecorator([{strategy:w,component:T}]);return n.state={syncContent:a,editorState:i?o.EditorState.createWithContent((0,o.convertFromRaw)(JSON.parse(i)),c):o.EditorState.createEmpty(c),placeholder:l,expandControl:u||!1,markdown:!1},n.onChange=n._onChange.bind(h(n)),n.toggleBlockType=function(e){return n._toggleBlockType(e)},n.toggleInlineStyle=function(e){return n._toggleInlineStyle(e)},n.addImage=n._addImage.bind(h(n)),n.addLink=n._addLink.bind(h(n)),n.updateImage=n._updateImage.bind(h(n)),n.handleKeyCommand=n._handleKeyCommand.bind(h(n)),n.mapKeyToEditorCommand=n._mapKeyToEditorCommand.bind(h(n)),n.mediaBlockRenderer=n.mediaBlockRenderer.bind(h(n)),n.media=n._media.bind(h(n)),n.setMarkdown=n.setMarkdown.bind(h(n)),n.insertText=n.insertText.bind(h(n)),n}var n,u;return v(t,e),y(t,[{key:\"setMarkdown\",value:function(){var e=this;this.setState({markdown:!this.state.markdown},(function(){l.default.save({key:\"markdown\",data:e.state.markdown}),e._onChange(e.state.editorState)}))}},{key:\"componentDidMount\",value:(n=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.onChange(this.state.editorState),this.props.getEditor(this.refs.editor),e.next=4,l.default.load({key:\"markdown\"});case 4:t=e.sent,this.refs.markdown&&t&&(this.refs.markdown.checked=!0,this.setState({markdown:!0}));case 6:case\"end\":return e.stop()}}),e,this)})),u=function(){var e=this,t=arguments;return new Promise((function(r,o){var a=n.apply(e,t);function i(e){s(a,r,o,i,l,\"next\",e)}function l(e){s(a,r,o,i,l,\"throw\",e)}i(void 0)}))},function(){return u.apply(this,arguments)})},{key:\"insertText\",value:function(e){var t=this.state.editorState,n=t.getCurrentContent(),r=o.Modifier.insertText(n,t.getSelection(),e),a=o.EditorState.push(t,r,\"insert-characters\");this.onChange(a)}},{key:\"_onChange\",value:function(e){this.setState({editorState:e},(function(){}));var t=this.state,n=t.syncContent,r=t.markdown;if(n){var l=e.getCurrentContent(),u={blockRenderers:{\"code-block\":function(t){var n=t.getKey(),r=e.getCurrentContent(),o=r.getBlockBefore(n),a=r.getBlockAfter(n),i=o&&o.getType(),l=a&&a.getType(),u=function(e){return e.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\").split(\" \").join(\"&nbsp;\").split(\"\\n\").join(\"<br>\\n\")}(t.getText());if(\"code-block\"!==i&&\"code-block\"===l)return\"<pre>\"+u;if(\"code-block\"===i&&\"code-block\"!==l)return u+\"</pre>\";return u}}},c=(0,a.stateToHTML)(l,u),s=c.replace(/<p>/gim,\"\");if(!(s=s.replace(/<\\/p>/gim,\"\")))return void n(\"\",\"\");if(r){c=(c=(c=(c=(c=(c=(c=c.replace(/\\<\\/p\\>\\<p\\>/g,\"\")).replace(/\\<\\/p\\>/g,\"\")).replace(/<[^>]+>/g,\"\")).replace(/\\&lt\\;/g,\"<\")).replace(/\\&gt\\;/g,\">\")).replace(/\\&nbsp\\;/g,\" \")).replace(/\\&amp\\;/g,\"&\");var d=new i.default.Converter;d.setOption(\"tables\",!0),d.setOption(\"simpleLineBreaks\",!0),c=d.makeHtml(c)}c=encodeURIComponent(c),n(JSON.stringify((0,o.convertToRaw)(l)),c)}}},{key:\"_toggleBlockType\",value:function(e){this.onChange(o.RichUtils.toggleBlockType(this.state.editorState,e))}},{key:\"_toggleInlineStyle\",value:function(e){this.onChange(o.RichUtils.toggleInlineStyle(this.state.editorState,e))}},{key:\"_addLink\",value:function(e){var t=this.state.editorState;if(t.getSelection().isCollapsed())alert(\"请先选取需要添加链接的文字内容\");else{var n=prompt(\"请输入url地址以http://或https://开头\",\"\");if(!n)return;var r=t.getCurrentContent().createEntity(\"LINK\",\"MUTABLE\",{url:n}),a=r.getLastCreatedEntityKey(),i=o.EditorState.set(t,{currentContent:r});this.onChange(o.RichUtils.toggleLink(i,i.getSelection(),a))}}},{key:\"_addImage\",value:function(e){this._promptForMedia(\"image\",e)}},{key:\"_updateImage\",value:function(e,t){var n=this.state.editorState.getCurrentContent();n.blockMap.map((function(r){r.findEntityRanges((function(r){var o=r.getEntity();if(o&&\"image\"==n.getEntity(o).getType()){var a=n.getEntity(o).getData();a.name==t.name&&(a.src=e,n.replaceEntityData(o,a))}}))})),this.onChange(o.RichUtils.toggleInlineStyle(this.state.editorState,null))}},{key:\"_promptForMedia\",value:function(e,t){var n=this.state.editorState,r=null;t.map((function(e){var t=n.getCurrentContent().createEntity(\"image\",\"IMMUTABLE\",e);r=t.getLastCreatedEntityKey();var a=o.AtomicBlockUtils.insertAtomicBlock(n,r,\" \");n=a})),this.onChange(n)}},{key:\"_handleKeyCommand\",value:function(e){var t=this.state.editorState,n=o.RichUtils.handleKeyCommand(t,e);return!!n&&(this.onChange(n),!0)}},{key:\"_mapKeyToEditorCommand\",value:function(e){switch(e.keyCode){case 9:var t=o.RichUtils.onTab(e,this.state.editorState,4);return void(t!==this.state.editorState&&this.onChange(t))}return(0,o.getDefaultKeyBinding)(e)}},{key:\"_media\",value:function(e){var t,n=this.state.editorState.getCurrentContent().getEntity(e.block.getEntityAt(0)),o=n.getData().src,a=n.getType();return\"link\"===a?t=r.default.createElement(\"a\",{href:o,target:\"_blank\",rel:\"nofollow\"},o):\"image\"===a&&(t=r.default.createElement(\"img\",{src:o})),t}},{key:\"mediaBlockRenderer\",value:function(e){switch(e.getType()){case\"atomic\":return{component:this.media,editable:!1,props:{foo:\"bar\"}}}}},{key:\"render\",value:function(){var e=this,t=this.state,n=t.editorState,a=t.placeholder,i=t.expandControl,l=t.markdown,u=this.props,c=u.displayControls,s=u.showMarkdown;return r.default.createElement(\"div\",{className:\"RichEditor-editor\"},c?r.default.createElement(\"div\",{className:\"d-flex justify-content-between border-bottom\"},r.default.createElement(j,{markdown:l,editorState:n,toggleBlockType:this.toggleBlockType,toggleInlineStyle:this.toggleInlineStyle,addImage:this.addImage,addLink:this.addLink,insertText:this.insertText,updateImage:this.updateImage,expandControl:i,handleExpandControl:function(){e.setState({expandControl:!e.state.expandControl})}}),s?r.default.createElement(\"div\",{style:{display:\"block-inline\",height:\"40px\",lineHeight:\"40px\",marginRight:\"15px\"}},r.default.createElement(\"input\",{ref:\"markdown\",type:\"checkbox\",id:\"markdown-input\",className:\"form-check-input\",onChange:this.setMarkdown,style:{marginTop:\"14px\"}}),r.default.createElement(\"label\",{className:\"form-check-label text-secondary\",htmlFor:\"markdown-input\"},\"MarkDown\")):null):null,r.default.createElement(o.Editor,{blockRendererFn:this.mediaBlockRenderer,editorState:n,blockStyleFn:k,onChange:this.onChange,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.mapKeyToEditorCommand,placeholder:a,ref:\"editor\",stripPastedStyles:!0,spellCheck:!0}))}}]),t}(r.default.Component);t.default=I,E={displayControls:!0,syncContent:null,content:\"\",getEditor:function(e){},placeholder:\"请输入正文\",showMarkdown:!1},(S=\"defaultProps\")in(C=I)?Object.defineProperty(C,S,{value:E,enumerable:!0,configurable:!0,writable:!0}):C[S]=E},805:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(e){var t=e.text,n=void 0===t?\"上传图片\":t,r=e.multiple,u=void 0===r||r,s=e.beforeUpload,d=void 0===s?function(){}:s,f=e.upload,p=void 0===f?function(){}:f,y=c((0,o.useState)(\"\"),2),m=y[0],h=y[1],g=c((0,o.useState)(\"\"),2),v=g[0],b=g[1],k=(0,i.useStore)();(0,o.useEffect)((function(){m||(0,l.getQiNiuToken)()(k.dispatch,k.getState).then((function(e){var t=c(e,2),n=(t[0],t[1]);n&&(h(n.token),b(n.url))}))}));return m?o.default.createElement(a.default,{text:n,multiple:u,accept:\"image/*\",token:m,onUpload:function(e){d(e),e.map((function(e){e.upload().then((function(t){t.text().then((function(t){t=JSON.parse(t),p(v+\"/\"+t.key,e)}))}))}))}}):o.default.createElement(\"span\",null)};var r,o=function(e){if(e&&e.__esModule)return e;var t=u();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}}n.default=e,t&&t.set(e,n);return n}(n(0)),a=(r=n(809))&&r.__esModule?r:{default:r},i=n(168),l=n(810);function u(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}},809:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(e){var t=e.token,n=e.text,i=void 0===n?\"上传图片\":n,l=(e.size,e.accept),u=void 0===l?\"*\":l,c=e.multiple,s=void 0===c||c,d=e.onUpload,f=void 0===d?function(e){}:d,p=(h=(0,r.useState)(a.default.qiniu.uploadUrl.http),g=2,function(e){if(Array.isArray(e))return e}(h)||function(e,t){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}}(h,g)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()),y=p[0],m=p[1];var h,g;(0,r.useEffect)((function(){\"https:\"===window.location.protocol&&m(a.default.qiniu.uploadUrl.https)}),[]);var v=function(e){if(!e||0===e.size)return null;var n=e.preview.split(\"/\").pop()+\".\"+e.name.split(\".\").pop();return new Promise((function(r){var a=new FormData;a.append(\"file\",e),a.append(\"token\",t),a.append(\"key\",n),a.append(\"x:filename\",e.name),a.append(\"x:size\",e.size),(0,o.default)(y,{method:\"POST\",body:a}).then((function(e){r(e)})).catch((function(e){r(e)}))}))};return r.default.createElement(\"span\",{className:\"_1Ic4W\"},i,r.default.createElement(\"input\",{className:\"a\",type:\"file\",accept:u,multiple:s,onChange:function(e){var t;e.preventDefault(),e.dataTransfer?t=e.dataTransfer.files:e.target&&(t=e.target.files);for(var n=s?t.length:1,r=[],o=0;o<n;o++)t[o].preview=URL.createObjectURL(t[o]),t[o].upload=function(e){return function(){return v(e)}}(t[o]),r.push(t[o]);f(r)}}))};var r=function(e){if(e&&e.__esModule)return e;var t=l();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}}n.default=e,t&&t.set(e,n);return n}(n(0)),o=i(n(705)),a=i(n(77));function i(e){return e&&e.__esModule?e:{default:e}}function l(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}n(706)},810:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getQiNiuToken=function(){return function(e,t){return new Promise(function(){var e,n=(e=regeneratorRuntime.mark((function e(n,r){var a,i,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.default)({apis:[{api:\"qiniuToken\",fields:\"\\n            token\\n            url\\n          \"}],headers:{accessToken:t().user.accessToken},cache:!0});case 2:a=e.sent,c=2,i=function(e){if(Array.isArray(e))return e}(r=a)||function(e,t){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}}(r,c)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}(),l=i[0],u=i[1],n(l?[l]:[null,u]);case 7:case\"end\":return e.stop()}var r,c}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function l(e){a(i,r,o,l,u,\"next\",e)}function u(e){a(i,r,o,l,u,\"throw\",e)}l(void 0)}))});return function(e,t){return n.apply(this,arguments)}}())}};var r,o=(r=n(48))&&r.__esModule?r:{default:r};function a(e,t,n,r,o,a,i){try{var l=e[a](i),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,o)}}}]);","extractedComments":[]}